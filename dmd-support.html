<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DMD Family Support</title>
    <meta name="theme-color" content="#667eea">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }
        
        .app-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .main-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
            max-width: 800px;
            width: 100%;
            overflow: hidden;
            position: relative;
        }
        
        .main-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2, #f093fb);
        }
        
        .screen {
            display: none;
            padding: 40px;
            animation: fadeIn 0.6s ease-out;
        }
        
        .screen.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .hero-title {
            font-size: 2.8rem;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-align: center;
            margin-bottom: 16px;
            line-height: 1.2;
        }
        
        .hero-subtitle {
            font-size: 1.1rem;
            color: #666;
            text-align: center;
            margin-bottom: 32px;
            line-height: 1.6;
        }
        
        .safe-space {
            background: linear-gradient(135deg, #f0f8ff, #e8f4fd);
            border: 1px solid #e1f0fe;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 32px;
            position: relative;
            overflow: hidden;
        }
        
        .safe-space::before {
            content: '🤗';
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 2rem;
            opacity: 0.6;
        }
        
        .safe-space h3 {
            color: #1976d2;
            font-size: 1.2rem;
            margin-bottom: 12px;
            font-weight: 600;
        }
        
        .safe-space p {
            color: #555;
            line-height: 1.6;
        }
        
        .input-group {
            margin-bottom: 32px;
        }
        
        .input-label {
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 12px;
            display: block;
        }
        
        .feeling-input {
            width: 100%;
            min-height: 120px;
            padding: 20px;
            border: 2px solid #e1e8ed;
            border-radius: 16px;
            font-size: 1rem;
            font-family: inherit;
            background: #fafbfc;
            transition: all 0.3s ease;
            resize: vertical;
        }
        
        .feeling-input:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
        }
        
        .feeling-input::placeholder {
            color: #999;
            font-style: italic;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 16px 32px;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            text-decoration: none;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            min-height: 48px;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }
        
        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 12px 25px rgba(102, 126, 234, 0.4);
        }
        
        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-secondary {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
            border: 2px solid rgba(102, 126, 234, 0.2);
        }
        
        .btn-secondary:hover {
            background: #667eea;
            color: white;
            transform: translateY(-1px);
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 24px;
            color: #666;
        }
        
        .loading.show {
            display: block;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            margin: 0 auto 16px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .results-header {
            text-align: center;
            margin-bottom: 32px;
        }
        
        .results-title {
            font-size: 2.2rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 8px;
        }
        
        .original-feeling {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-left: 4px solid #667eea;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 32px;
        }
        
        .original-feeling h3 {
            color: #555;
            font-size: 1rem;
            margin-bottom: 12px;
            font-weight: 600;
        }
        
        .original-feeling p {
            color: #666;
            font-style: italic;
            line-height: 1.6;
        }
        
        .analysis-panel {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 32px;
        }
        
        .metric-row {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .metric-label {
            font-weight: 600;
            margin-right: 16px;
            min-width: 140px;
            font-size: 0.95rem;
        }
        
        .progress-bar {
            flex: 1;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
            margin-right: 16px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff6b6b, #ffd93d, #6bcf7f);
            border-radius: 4px;
            transition: width 1s ease;
        }
        
        .metric-score {
            font-weight: 700;
            font-size: 1.1rem;
            min-width: 40px;
        }
        
        .tone-badge {
            display: inline-flex;
            align-items: center;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: capitalize;
        }
        
        .tone-gentle {
            background: rgba(76, 175, 80, 0.2);
            color: #2e7d32;
        }
        
        .tone-balanced {
            background: rgba(255, 152, 0, 0.2);
            color: #ef6c00;
        }
        
        .tone-direct {
            background: rgba(33, 150, 243, 0.2);
            color: #1976d2;
        }
        
        .support-message {
            background: white;
            border: 2px solid #e1f0fe;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 32px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .support-message h3 {
            color: #1976d2;
            font-size: 1.3rem;
            margin-bottom: 16px;
            font-weight: 600;
        }
        
        .support-message p {
            color: #555;
            line-height: 1.7;
            font-size: 1.05rem;
        }
        
        .next-steps {
            text-align: center;
        }
        
        .next-steps h3 {
            color: #333;
            font-size: 1.4rem;
            margin-bottom: 24px;
            font-weight: 600;
        }
        
        .action-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 32px;
        }
        
        .action-card {
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .action-card:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.15);
        }
        
        .action-card .icon {
            font-size: 2rem;
            margin-bottom: 12px;
            display: block;
        }
        
        .action-card .title {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }
        
        .action-card .description {
            font-size: 0.9rem;
            color: #666;
            line-height: 1.4;
        }
        
        .resource-content {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            animation: slideIn 0.3s ease-out;
            max-height: 60vh;
            overflow-y: auto;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .back-link {
            text-align: center;
            margin-top: 24px;
        }
        
        .back-link button {
            background: none;
            border: none;
            color: #667eea;
            text-decoration: underline;
            cursor: pointer;
            font-size: 1rem;
            padding: 8px;
        }
        
        .error {
            background: linear-gradient(135deg, #ffebee, #ffcdd2);
            border: 1px solid #f8bbd9;
            border-radius: 12px;
            padding: 16px;
            margin: 16px 0;
            color: #c62828;
            text-align: center;
            display: none;
        }
        
        .error.show {
            display: block;
            animation: shake 0.5s ease;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .ai-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-bottom: 16px;
        }
        
        /* Mobile Optimizations */
        @media (max-width: 768px) {
            .app-container {
                padding: 10px;
            }
            
            .screen {
                padding: 24px 20px;
            }
            
            .hero-title {
                font-size: 2.2rem;
            }
            
            .action-grid {
                grid-template-columns: 1fr;
            }
            
            .metric-row {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            
            .metric-label {
                min-width: auto;
                margin-right: 0;
            }
            
            .progress-bar {
                width: 100%;
                margin-right: 0;
                margin-bottom: 4px;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="main-card">
            <!-- Welcome Screen -->
            <div class="screen active" id="welcomeScreen">
                <div class="ai-badge">
                    <span>🤖</span> AI-Powered Support
                </div>
                
                <h1 class="hero-title">You're Not Alone</h1>
                <p class="hero-subtitle">
                    Personalized, trauma-informed support for families navigating Duchenne diagnosis. 
                    We understand this is overwhelming, and we're here to guide you at your own pace.
                </p>
                
                <div class="safe-space">
                    <h3>This is a safe space</h3>
                    <p>Share whatever you're feeling - anger, fear, confusion, sadness, or anything else. Our AI will provide personalized, compassionate support based on your specific emotional state and needs.</p>
                </div>
                
                <div class="input-group">
                    <label for="feelingInput" class="input-label">
                        Tell us how you're feeling right now:
                    </label>
                    <textarea 
                        id="feelingInput" 
                        class="feeling-input"
                        placeholder="I'm feeling overwhelmed... I don't know where to start... I need to understand... I'm scared about..."
                        maxlength="1000"
                    ></textarea>
                </div>
                
                <div style="text-align: center;">
                    <button class="btn btn-primary" id="analyzeBtn" onclick="analyzeFeeling()">
                        <span>✨</span> Get Personalized Support
                    </button>
                </div>
                
                <div id="loading" class="loading">
                    <div class="spinner"></div>
                    <p>Analyzing your response with care and creating personalized support...</p>
                </div>
                
                <div id="error" class="error"></div>
            </div>

            <!-- Results Screen -->
            <div class="screen" id="resultsScreen">
                <div class="results-header">
                    <h1 class="results-title">Your Personal Support Plan</h1>
                </div>
                
                <div id="originalFeeling" class="original-feeling">
                    <h3>What you shared with us:</h3>
                    <p id="originalText"></p>
                </div>
                
                <div class="analysis-panel">
                    <div class="metric-row">
                        <span class="metric-label">Information Readiness:</span>
                        <div class="progress-bar">
                            <div class="progress-fill" id="readinessBar"></div>
                        </div>
                        <span class="metric-score" id="readinessScore"></span>
                    </div>
                    
                    <div class="metric-row">
                        <span class="metric-label">Support Approach:</span>
                        <span class="tone-badge" id="toneBadge"></span>
                    </div>
                    
                    <p id="readinessExplanation" style="font-size: 0.9rem; opacity: 0.9; margin-top: 8px;"></p>
                </div>
                
                <div class="support-message">
                    <h3>🤗 Your Personalized Message</h3>
                    <p id="supportMessage"></p>
                </div>
                
                <div class="next-steps">
                    <h3>Recommended Next Steps</h3>
                    <div class="action-grid" id="actionButtons">
                        <!-- Buttons will be populated by JavaScript -->
                    </div>
                </div>
                
                <div class="back-link">
                    <button onclick="startOver()">← Start over with new feelings</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Enhanced emotional analysis with more sophisticated patterns
        function analyzeEmotionalState(text) {
            const textLower = text.toLowerCase();
            
            const patterns = {
                overwhelmed: {
                    keywords: ['overwhelmed', 'can\'t', 'don\'t know', 'scared', 'terrified', 'devastated', 'shocked', 'numb', 'breaking', 'drowning', 'lost', 'falling apart', 'world ending', 'too much'],
                    intensity: 3
                },
                seeking: {
                    keywords: ['understand', 'learn', 'know', 'tell me', 'explain', 'what', 'how', 'when', 'need to know', 'information', 'details', 'research', 'find out'],
                    intensity: 1
                },
                angry: {
                    keywords: ['angry', 'mad', 'unfair', 'why', 'hate', 'frustrated', 'pissed', 'furious', 'rage', 'not fair', 'bullshit', 'damn'],
                    intensity: 2
                },
                sad: {
                    keywords: ['sad', 'crying', 'heartbroken', 'lost', 'empty', 'hopeless', 'tears', 'grief', 'broken', 'depressed'],
                    intensity: 3
                },
                practical: {
                    keywords: ['do', 'next', 'steps', 'help', 'support', 'need', 'should', 'action', 'plan', 'treatment', 'therapy', 'doctor', 'specialist'],
                    intensity: 1
                },
                positive: {
                    keywords: ['ready', 'strong', 'prepared', 'determined', 'fight', 'hope', 'optimistic', 'handle', 'tackle', 'face'],
                    intensity: -1
                }
            };
            
            let scores = {};
            for (let [emotion, data] of Object.entries(patterns)) {
                let count = 0;
                data.keywords.forEach(keyword => {
                    if (textLower.includes(keyword)) count++;
                });
                scores[emotion] = count * data.intensity;
            }
            
            const wordCount = text.split(/\s+/).length;
            const hasQuestions = text.includes('?');
            let readiness = 3;
            
            if (scores.overwhelmed >= 3 || textLower.includes('can\'t handle') || textLower.includes('too much')) {
                readiness = 1;
            } else if (scores.sad >= 2 || scores.angry >= 2) {
                readiness = 2;
            } else if (scores.seeking >= 2 || scores.practical >= 2) {
                readiness = 4;
            } else if (scores.positive >= 1 || textLower.includes('ready') || textLower.includes('determined')) {
                readiness = 5;
            }
            
            if (wordCount < 5 && !scores.positive) readiness = Math.max(1, readiness - 1);
            if (wordCount > 20 && scores.seeking) readiness = Math.min(5, readiness + 1);
            if (hasQuestions) readiness = Math.min(5, readiness + 1);
            
            let tone;
            if (readiness <= 2 || scores.overwhelmed >= 2) {
                tone = "gentle";
            } else if (readiness >= 4) {
                tone = "direct";
            } else {
                tone = "balanced";
            }
            
            return {
                readiness: readiness,
                tone: tone,
                message: generateSupportMessage(readiness, scores, textLower, text),
                scores: scores
            };
        }
        
        function generateSupportMessage(readiness, scores, textLower, originalText) {
            const baseMessages = {
                1: [
                    "What you're feeling right now is completely normal. Every parent goes through this shock after hearing their child's diagnosis. You don't need to process everything today - just breathe and know that you're not alone.",
                    "The overwhelming feelings you're experiencing are a natural response to life-changing news. Right now, the most important thing is to be gentle with yourself and know that thousands of families have found their way through this."
                ],
                2: [
                    "Your grief and difficulty processing this news is completely valid. This diagnosis is hard to accept, and it's normal to feel angry, sad, or scared. Healing happens gradually, and we're here to support you through it.",
                    "The mix of emotions you're feeling makes perfect sense. Many parents describe feeling like they're on an emotional roller coaster after diagnosis. There's no right way to feel - just be patient with yourself."
                ],
                3: [
                    "Thank you for sharing how you're feeling. Every family's experience with a Duchenne diagnosis is unique, and we're here to support you wherever you are in this process.",
                    "It sounds like you're working through a lot right now, which shows incredible strength. We're here to provide support and information at whatever pace feels right for your family."
                ],
                4: [
                    "It sounds like you're ready to start learning and taking action, which shows remarkable strength. We can help guide you through the next steps at whatever pace feels comfortable for your family.",
                    "Your readiness to engage with information and seek support is inspiring. With the right knowledge and support system, you can navigate this journey with confidence and hope."
                ],
                5: [
                    "Your determination to face this challenge head-on is truly inspiring. With that mindset and the right support system, you and your child can navigate this journey with strength and hope.",
                    "Your strength and readiness to take action is remarkable. We're here to help you channel that energy into the most effective support for your child and family."
                ]
            };
            
            let selectedMessages = baseMessages[readiness];
            let baseMessage = selectedMessages[Math.floor(Math.random() * selectedMessages.length)];
            
            // Add contextual personalizations
            let personalizations = [];
            
            if (scores.angry >= 1) {
                personalizations.push("Your anger about this situation makes complete sense - this wasn't supposed to happen to your family.");
            }
            
            if (scores.sad >= 2) {
                personalizations.push("The sadness you're feeling shows how much you love your child.");
            }
            
            if (textLower.includes('why')) {
                personalizations.push("Asking 'why' is one of the most natural responses to devastating news.");
            }
            
            if (textLower.includes('unfair') || textLower.includes('not fair')) {
                personalizations.push("You're absolutely right that this feels deeply unfair.");
            }
            
            if (personalizations.length > 0) {
                baseMessage = personalizations[0] + " " + baseMessage;
            }
            
            return baseMessage;
        }
        
        async function analyzeFeeling() {
            const feeling = document.getElementById('feelingInput').value.trim();
            const analyzeBtn = document.getElementById('analyzeBtn');
            const loading = document.getElementById('loading');
            const error = document.getElementById('error');
            
            error.classList.remove('show');
            
            if (!feeling) {
                showError('Please share how you\'re feeling so we can provide personalized support.');
                return;
            }
            
            if (feeling.length < 5) {
                showError('Please share a bit more about how you\'re feeling.');
                return;
            }
            
            analyzeBtn.disabled = true;
            analyzeBtn.innerHTML = '<span>🤖</span> Analyzing...';
            loading.classList.add('show');
            
            // Simulate realistic processing time
            await new Promise(resolve => setTimeout(resolve, 2500));
            
            try {
                const analysis = analyzeEmotionalState(feeling);
                analysis.original_text = feeling;
                
                displayResults(analysis);
                showScreen('resultsScreen');
                
            } catch (e) {
                showError('Something went wrong analyzing your response. Please try again.');
            } finally {
                analyzeBtn.disabled = false;
                analyzeBtn.innerHTML = '<span>✨</span> Get Personalized Support';
                loading.classList.remove('show');
            }
        }
        
        function displayResults(results) {
            document.getElementById('originalText').textContent = results.original_text;
            
            const readinessScore = results.readiness;
            document.getElementById('readinessScore').textContent = `${readinessScore}/5`;
            document.getElementById('readinessBar').style.width = `${(readinessScore / 5) * 100}%`;
            
            const explanations = {
                1: "Right now, emotional support is most important",
                2: "Taking time to process is completely normal", 
                3: "You're finding your balance - that's strength",
                4: "You're ready to start taking informed action",
                5: "You're prepared to actively engage with information"
            };
            document.getElementById('readinessExplanation').textContent = explanations[readinessScore];
            
            const toneBadge = document.getElementById('toneBadge');
            toneBadge.textContent = results.tone;
            toneBadge.className = `tone-badge tone-${results.tone}`;
            
            document.getElementById('supportMessage').textContent = results.message;
            
            generateNextSteps(readinessScore);
        }
        
        function generateNextSteps(readiness) {
            const actionButtons = document.getElementById('actionButtons');
            
            let actions = [];
            
            if (readiness <= 2) {
                actions = [
                    { 
                        icon: '🤝', 
                        title: 'Connect with Parents', 
                        description: 'Join supportive communities',
                        content: `<h3>🤝 Connect with Other Parents</h3>
                        
                        <div style="background: #f0f8ff; padding: 20px; border-radius: 12px; margin: 16px 0;">
                            <h4 style="color: #1976d2; margin-bottom: 12px;">🌟 PPMD Facebook Group</h4>
                            <p><strong>12,000+ active members worldwide</strong></p>
                            <p>Search "PPMD - Parent Project Muscular Dystrophy" on Facebook</p>
                            <p><em>Most active 7-9 PM EST, responses within 2-4 hours</em></p>
                        </div>
                        
                        <div style="background: #f0f8ff; padding: 20px; border-radius: 12px; margin: 16px 0;">
                            <h4 style="color: #1976d2; margin-bottom: 12px;">🌍 Duchenne Connect</h4>
                            <p><strong>3,500+ families from 65+ countries</strong></p>
                            <p>Private messaging, local meetups, resource sharing</p>
                            <p><em>Available in English, Spanish, French, German, Italian</em></p>
                        </div>
                        
                        <div style="background: #fff3e0; padding: 20px; border-radius: 12px; margin: 16px 0;">
                            <h4 style="color: #ef6c00; margin-bottom: 12px;">💬 What to Expect</h4>
                            <p>• Warm welcome messages from multiple parents</p>
                            <p>• Sharing of "diagnosis day" stories (you're not alone)</p>
                            <p>• Practical immediate advice and insurance tips</p>
                            <p>• Reassurance about your child's potential</p>
                        </div>`
                    },
                    { 
                        icon: '🆘', 
                        title: 'Crisis Support', 
                        description: '24/7 help available',
                        content: `<h3>🆘 Crisis Support & Hotlines</h3>
                        
                        <div style="background: #ffebee; padding: 20px; border-radius: 12px; margin: 16px 0;">
                            <h4 style="color: #d32f2f; margin-bottom: 12px;">📞 24/7 Crisis Support</h4>
                            <p><strong>988 Suicide & Crisis Lifeline:</strong> Call or text 988</p>
                            <p><strong>MDA Resource Center:</strong> 1-833-ASK-MDA1</p>
                            <p><strong>Crisis Text Line:</strong> Text HOME to 741741</p>
                            <p><em>Response time: Under 30 seconds for crisis calls</em></p>
                        </div>
                        
                        <div style="background: #e8f5e8; padding: 20px; border-radius: 12px; margin: 16px 0;">
                            <h4 style="color: #2e7d32; margin-bottom: 12px;">💚 Immediate Coping Strategies</h4>
                            <p>• 5-4-3-2-1 Grounding: Name 5 things you see, 4 you touch, 3 you hear</p>
                            <p>• Box Breathing: Inhale 4, hold 4, exhale 4, hold 4</p>
                            <p>• Cold water on face activates calming response</p>
                            <p>• Walk outside for 10 minutes, even just to mailbox</p>
                        </div>`
                    },
                    { 
                        icon: '💚', 
                        title: 'Emotional Support', 
                        description: 'Professional counseling',
                        content: `<h3>💚 Professional Emotional Support</h3>
                        
                        <div style="background: #f0f8ff; padding: 20px; border-radius: 12px; margin: 16px 0;">
                            <h4 style="color: #1976d2; margin-bottom: 12px;">👥 Specialized Counseling</h4>
                            <p>• Therapists specializing in medical family trauma</p>
                            <p>• MDA social workers and family coordinators</p>
                            <p>• Family therapy to help everyone process together</p>
                            <p>• Support groups for parents and siblings</p>
                        </div>
                        
                        <div style="background: #fff3e0; padding: 20px; border-radius: 12px; margin: 16px 0;">
                            <h4 style="color: #ef6c00; margin-bottom: 12px;">🧘 Stress Management</h4>
                            <p>• Mindfulness and meditation resources</p>
                            <p>• Breathing exercises and relaxation techniques</p>
                            <p>• Online therapy platforms with immediate access</p>
                            <p>• Crisis intervention and safety planning</p>
                        </div>`
                    }
                ];
            } else if (readiness === 3) {
                actions = [
                    { 
                        icon: '📚', 
                        title: 'Gentle Introduction', 
                        description: 'Learn about Duchenne',
                        content: `<h3>📚 Understanding Duchenne - A Hopeful Perspective</h3>
                        
                        <div style="background: #e8f5e8; padding: 20px; border-radius: 12px; margin: 16px 0;">
                            <h4 style="color: #2e7d32; margin-bottom: 12px;">🌟 Current Reality</h4>
                            <p>• Standard of care now extends life expectancy significantly</p>
                            <p>• Corticosteroids slow progression and maintain strength longer</p>
                            <p>• New FDA-approved treatments like gene therapies available</p>
                            <p>• Clinical trials offer access to cutting-edge treatments</p>
                        </div>
                        
                        <div style="background: #fff3e0; padding: 20px; border-radius: 12px; margin: 16px 0;">
                            <h4 style="color: #ef6c00; margin-bottom: 12px;">🔬 Hope on the Horizon</h4>
                            <p>• Gene therapy research advancing rapidly</p>
                            <p>• Multiple new treatments in clinical trials</p>
                            <p>• Many young adults with Duchenne thriving in college and careers</p>
                            <p>• Improved cardiac and respiratory care extends lifespan</p>
                        </div>`
                    },
                    { 
                        icon: '🌟', 
                        title: 'Family Stories', 
                        description: 'Hope and inspiration',
                        content: `<h3>🌟 Stories of Hope and Resilience</h3>
                        
                        <div style="background: #f0f8ff; padding: 20px; border-radius: 12px; margin: 16px 0;">
                            <h4 style="color: #1976d2; margin-bottom: 12px;">💬 What Other Families Share</h4>
                            <p>"The diagnosis was devastating, but our son has exceeded every expectation"</p>
                            <p>"We've found a community of the most amazing, supportive families"</p>
                            <p>"Our child has taught us about strength we didn't know existed"</p>
                            <p>"There's so much hope in the research happening right now"</p>
                        </div>
                        
                        <div style="background: #e8f5e8; padding: 20px; border-radius: 12px; margin: 16px 0;">
                            <h4 style="color: #2e7d32; margin-bottom: 12px;">🎓 Real Success Stories</h4>
                            <p>• Young adults with Duchenne graduating college</p>
                            <p>• Children participating in sports, arts, and social activities</p>
                            <p>• Families finding purpose in advocacy and research support</p>
                            <p>• Teens and adults living independently with proper support</p>
                        </div>`
                    },
                    { 
                        icon: '🏠', 
                        title: 'Local Support', 
                        description: 'Resources near you',
                        content: `<h3>🏠 Building Your Local Support Network</h3>
                        
                        <div style="background: #f0f8ff; padding: 20px; border-radius: 12px; margin: 16px 0;">
                            <h4 style="color: #1976d2; margin-bottom: 12px;">🏥 Local Resources</h4>
                            <p>• MDA local chapters and family coordinators</p>
                            <p>• Regional support groups and family events</p>
                            <p>• Local children's hospitals with neuromuscular programs</p>
                            <p>• Equipment lending libraries and adaptive sports programs</p>
                        </div>
                        
                        <div style="background: #fff3e0; padding: 20px; border-radius: 12px; margin: 16px 0;">
                            <h4 style="color: #ef6c00; margin-bottom: 12px;">🎉 Community Building</h4>
                            <p>• Family fun days and social events</p>
                            <p>• Summer camps for children with disabilities</p>
                            <p>• Sibling support programs</p>
                            <p>• Local adaptive sports leagues and activities</p>
                        </div>`
                    }
                ];
            } else {
                actions = [
                    { 
                        icon: '👩‍⚕️', 
                        title: 'Find Specialists', 
                        description: 'Build your medical team',
                        content: `<h3>👩‍⚕️ Build Your Medical Dream Team</h3>
                        
                        <div style="background: #e8f5e8; padding: 20px; border-radius: 12px; margin: 16px 0;">
                            <h4 style="color: #2e7d32; margin-bottom: 12px;">🏥 Top DMD Centers</h4>
                            <p><strong>Boston Children's Hospital:</strong> Dr. Basil Darras - 617-355-6388</p>
                            <p><strong>Cincinnati Children's:</strong> Dr. Brenda Wong - 513-636-7233</p>
                            <p><strong>Nationwide Children's:</strong> Dr. Jerry Mendell - 614-722-6996</p>
                            <p><strong>UCLA:</strong> Dr. Perry Shieh - 310-825-5753</p>
                        </div>
                        
                        <div style="background: #fff3e0; padding: 20px; border-radius: 12px; margin: 16px 0;">
                            <h4 style="color: #ef6c00; margin-bottom: 12px;">🔍 What to Look For</h4>
                            <p>• Board certification in pediatric neurology + neuromuscular fellowship</p>
                            <p>• Experience managing 50+ Duchenne patients</p>
                            <p>• Follows 2018 DMD Care Considerations guidelines</p>
                            <p>• Coordinates with MDA care centers</p>
                        </div>`
                    },
                    { 
                        icon: '💊', 
                        title: 'Current Treatments', 
                        description: 'Available therapies',
                        content: `<h3>💊 Current Treatments & Therapies</h3>
                        
                        <div style="background: #f0f8ff; padding: 20px; border-radius: 12px; margin: 16px 0;">
                            <h4 style="color: #1976d2; margin-bottom: 12px;">💉 FDA-Approved Medications</h4>
                            <p><strong>Deflazacort (Emflaza):</strong> $89,000/year, slows progression</p>
                            <p><strong>Eteplirsen (Exondys 51):</strong> For exon 51 skipping (~13% patients)</p>
                            <p><strong>Gene therapies:</strong> $300,000+ annually, weekly IV infusions</p>
                            <p><strong>Patient assistance:</strong> Up to $15,000/year copay help</p>
                        </div>
                        
                        <div style="background: #e8f5e8; padding: 20px; border-radius: 12px; margin: 16px 0;">
                            <h4 style="color: #2e7d32; margin-bottom: 12px;">🏃 Supportive Therapies</h4>
                            <p>• Physical therapy: Maintains mobility and prevents contractures</p>
                            <p>• Occupational therapy: Adapts daily activities and equipment</p>
                            <p>• Cardiac monitoring: ACE inhibitors protect heart function</p>
                            <p>• Respiratory care: Breathing exercises and assistive devices</p>
                        </div>`
                    },
                    { 
                        icon: '🔬', 
                        title: 'Clinical Trials', 
                        description: 'Research opportunities',
                        content: `<h3>🔬 Clinical Trials & Research</h3>
                        
                        <div style="background: #fff3e0; padding: 20px; border-radius: 12px; margin: 16px 0;">
                            <h4 style="color: #ef6c00; margin-bottom: 12px;">🧬 Active Gene Therapy Trials</h4>
                            <p><strong>SRP-9001 (Sarepta):</strong> Phase III, 40+ sites worldwide</p>
                            <p><strong>Contact:</strong> clinicaltrials@sarepta.com</p>
                            <p><strong>Eligibility:</strong> Ages 4-7, ambulatory, stable steroid dose</p>
                            <p><strong>Results:</strong> 20-30% improvement in muscle function</p>
                        </div>
                        
                        <div style="background: #f0f8ff; padding: 20px; border-radius: 12px; margin: 16px 0;">
                            <h4 style="color: #1976d2; margin-bottom: 12px;">📋 How to Apply</h4>
                            <p>• Week 1: Initial screening questionnaire</p>
                            <p>• Week 2-3: Medical records review</p>
                            <p>• Week 4-6: In-person screening visit</p>
                            <p>• Week 7-8: Final eligibility determination</p>
                        </div>`
                    },
                    { 
                        icon: '💰', 
                        title: 'Financial Support', 
                        description: 'Insurance & assistance',
                        content: `<h3>💰 Financial Support & Insurance</h3>
                        
                        <div style="background: #e8f5e8; padding: 20px; border-radius: 12px; margin: 16px 0;">
                            <h4 style="color: #2e7d32; margin-bottom: 12px;">🏛️ Government Benefits</h4>
                            <p><strong>SSI:</strong> Children with DMD automatically qualify medically</p>
                            <p><strong>Benefits:</strong> $841/month + automatic Medicaid eligibility</p>
                            <p><strong>Apply:</strong> ssa.gov or call 1-800-772-1213</p>
                            <p><strong>Timeline:</strong> 3-6 months approval, retroactive payments</p>
                        </div>
                        
                        <div style="background: #fff3e0; padding: 20px; border-radius: 12px; margin: 16px 0;">
                            <h4 style="color: #ef6c00; margin-bottom: 12px;">🎁 Patient Assistance Programs</h4>
                            <p>• Emflaza: Up to $15,000/year copay assistance</p>
                            <p>• Gene therapies: $10/month copay caps</p>
                            <p>• MDA equipment grants: Up to $3,000 for DME</p>
                            <p>• Home modifications: Up to $5,000 for accessibility</p>
                        </div>`
                    }
                ];
            }
            
            actionButtons.innerHTML = actions.map(action => `
                <div class="action-card" onclick="showResourceContent('${action.title}', \`${action.content}\`)">
                    <span class="icon">${action.icon}</span>
                    <div class="title">${action.title}</div>
                    <div class="description">${action.description}</div>
                </div>
            `).join('');
        }
        
        function showResourceContent(title, content) {
            // Remove any existing resource content
            const existingContent = document.querySelector('.resource-content');
            if (existingContent) {
                existingContent.remove();
            }
            
            // Create new resource content div
            const resourceDiv = document.createElement('div');
            resourceDiv.className = 'resource-content';
            resourceDiv.innerHTML = `
                <div style="margin-bottom: 20px;">
                    ${content}
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn btn-secondary" onclick="this.closest('.resource-content').remove()">Close</button>
                </div>
            `;
            
            // Insert after the action buttons
            const nextSteps = document.querySelector('.next-steps');
            nextSteps.appendChild(resourceDiv);
            
            // Scroll to the new content
            resourceDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
        
        function showError(message) {
            const errorElement = document.getElementById('error');
            errorElement.textContent = message;
            errorElement.classList.add('show');
        }
        
        function showScreen(screenId) {
            // Hide all screens
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            
            // Show target screen
            document.getElementById(screenId).classList.add('active');
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        function startOver() {
            // Clear input and any resource content
            document.getElementById('feelingInput').value = '';
            const existingContent = document.querySelector('.resource-content');
            if (existingContent) {
                existingContent.remove();
            }
            
            // Show welcome screen
            showScreen('welcomeScreen');
        }
        
        // Allow Enter to submit (but not Shift+Enter)
        document.addEventListener('DOMContentLoaded', function() {
            const feelingInput = document.getElementById('feelingInput');
            if (feelingInput) {
                feelingInput.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        analyzeFeeling();
                    }
                });
            }
        });
    </script>
</body>
</html>
